write.csv(CYTOKINES_ImmuneXpresso_Oscar, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Input),]
View(CYTOKINES_ImmuneXpresso.corrected)
setdiff(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol, CYTOKINES_ImmuneXpresso_Maisa)
# ***************
# ImmuneXpresso database
# database.ImmuneXpresso_Oscar <- read.csv("Ligand_Receptors_Rdata/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
database.ImmuneXpresso_Oscar_v2 <- read.csv("Ligand_Receptors_Rdata/Maisa_download/ImmuneXpressoResults_v2.csv", header = TRUE, sep = ',')
# database.ImmuneXpresso_Maisa <- read.csv("Ligand_Receptors_Rdata/Maisa_download/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
CYTOKINES_ImmuneXpresso_Maisa <- unique(database.ImmuneXpresso_Maisa$Cytokine.Ontology.Label)
# ***************
# ImmuneXpresso database
# database.ImmuneXpresso_Oscar <- read.csv("Ligand_Receptors_Rdata/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
# database.ImmuneXpresso_Oscar_v2 <- read.csv("Ligand_Receptors_Rdata/Maisa_download/ImmuneXpressoResults_v2.csv", header = TRUE, sep = ',')
database.ImmuneXpresso_Maisa <- read.csv("Ligand_Receptors_Rdata/Maisa_download/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
CYTOKINES_ImmuneXpresso_Maisa <- unique(database.ImmuneXpresso_Maisa$Cytokine.Ontology.Label)
setdiff(unique(database.ImmuneXpresso_Oscar$Label),CYTOKINES_ImmuneXpresso_Maisa)
CYTOKINES_ImmuneXpresso_Maisa <- unique(database.ImmuneXpresso_Maisa$Cytokine.Ontology.Label)
CYTOKINES_ImmuneXpresso_Maisa
# CYTOKINES_ImmuneXpresso_Oscar <- unique(database.ImmuneXpresso_Oscar$Label)
# setdiff(CYTOKINES_ImmuneXpresso_Oscar, CYTOKINES_ImmuneXpresso_Maisa)
write.csv(CYTOKINES_ImmuneXpresso_Maisa, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
# CYTOKINES_ImmuneXpresso_Oscar <- unique(database.ImmuneXpresso_Oscar$Label)
# setdiff(CYTOKINES_ImmuneXpresso_Oscar, CYTOKINES_ImmuneXpresso_Maisa)
# write.csv(CYTOKINES_ImmuneXpresso_Maisa, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Input),]
setdiff(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol, CYTOKINES_ImmuneXpresso_Maisa)
CYTOKINES_ImmuneXpresso.corrected
CYTOKINES_ImmuneXpresso_Maisa
View(CYTOKINES_ImmuneXpresso.corrected)
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol
# Matching with Ramilowski L-R pairs (only ligands)
keep_pairs <- which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_ImmuneXpresso.corrected$Approved.symbol)
CYTOKINE.pairs_ImmuneXpresso <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_ImmuneXpresso <- unique(CYTOKINE.pairs_ImmuneXpresso$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
we_have_more
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
View(database.ImmuneXpresso_Maisa)
View(database_Oscar)
View(CellPhoneDB.database_Maisa)
View(CellPhoneDB.database_Oscar)
# ***************
# CellPhoneDB database
CellPhoneDB.database_Oscar <- read.csv("Ligand_Receptors_Rdata/cellphonedb_protein_curated.csv", header = TRUE, sep = ",")
keep_Oscar <- unique(c(grep("Cytokine", CellPhoneDB.database_Oscar$secreted_desc, fixed = FALSE), grep("Cytokine", CellPhoneDB.database_Oscar$receptor_desc, fixed = FALSE)))
keep_Maisa <- unique(c(grep("Cytokine", CellPhoneDB.database_Maisa$secreted_desc, fixed = FALSE)))
# ***************
# CellPhoneDB database
CellPhoneDB.database_Oscar <- read.csv("Ligand_Receptors_Rdata/cellphonedb_protein_curated.csv", header = TRUE, sep = ",")
CellPhoneDB.database_Maisa <- read.csv("Ligand_Receptors_Rdata/Maisa_download/protein_complex_cellphonedb.csv", header = TRUE, sep = ",")
keep_Oscar <- unique(c(grep("Cytokine", CellPhoneDB.database_Oscar$secreted_desc, fixed = FALSE), grep("Cytokine", CellPhoneDB.database_Oscar$receptor_desc, fixed = FALSE)))
keep_Maisa <- unique(c(grep("Cytokine", CellPhoneDB.database_Maisa$secreted_desc, fixed = FALSE)))
CYTOKINES_CellPhoneDB <- CellPhoneDB.database_Maisa[keep_Maisa,]
CYTOKINES_CellPhoneDB <- sapply(strsplit(CYTOKINES_CellPhoneDB$entry_name[1:146], split = "_", fixed = T), head, 1)
CYTOKINES_CellPhoneDB.corrected
View(CYTOKINES_CellPhoneDB.corrected)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
View(CYTOKINES_CellPhoneDB.corrected)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
# Matching with Ramilowski
keep_pairs <- unique(c(which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol),
which(LR.pairs.Ramilowski$Receptor.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol)))
CYTOKINE.pairs_CellPhoneDB <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_CellPhoneDB <- unique(CYTOKINE.pairs_CellPhoneDB$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
we_have_more
View(CYTOKINE.pairs_CellPhoneDB)
# ***************
# ImmuneXpresso database:
# file to be downloaded: interactions betweeen selected cells and cytokines under certain context
database.ImmuneXpresso <- read.csv("Ligand_Receptors_Rdata/Maisa_download/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
CYTOKINES_ImmuneXpresso <- unique(database.ImmuneXpresso_Oscar$Label)
# ***************
# ImmuneXpresso database:
# file to be downloaded: interactions betweeen selected cells and cytokines under certain context
database.ImmuneXpresso <- read.csv("Ligand_Receptors_Rdata/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
View(database.ImmuneXpresso)
CYTOKINES_ImmuneXpresso <- unique(database.ImmuneXpresso$Cytokine.Ontology.Label)
# ***************
# iTALK database
load("Ligand_Receptors_Rdata/iTALK_database.rda")
database_Oscar <- database
load("Ligand_Receptors_Rdata/Maisa_download/LR_database.rda")
database_Maisa <- database
cytokine.iTALK <- subset(database_Oscar, Classification == "cytokine")
CYTOKINE.pairs_iTALK <- cytokine.iTALK$Pair.Name
CYTOKINES_iTALK <- unique(c(sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), head, 1), sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), tail, 1)))
# Obtaining cytokine pairs from iTALK database
keep_pairs <- intersect(which(cytokine.iTALK$Ligand.ApprovedSymbol %in% CYTOKINES_iTALK),
which(cytokine.iTALK$Receptor.ApprovedSymbol %in% CYTOKINES_iTALK))
CYTOKINE.pairs_iTALK <- cytokine.iTALK[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
# ***************
# ImmuneXpresso database:
# file to be downloaded: interactions betweeen selected cells and cytokines under certain context
database.ImmuneXpresso <- read.csv("Ligand_Receptors_Rdata/ImmuneXpressoResults.csv", header = TRUE, sep = ',')
CYTOKINES_ImmuneXpresso <- unique(database.ImmuneXpresso$Cytokine.Ontology.Label)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_ImmuneXpresso_Maisa, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
# Take corrected HGNC symbols:
write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
database_Oscar <- database
load("Ligand_Receptors_Rdata/Maisa_download/LR_database.rda")
# ***************
# iTALK database
load("Ligand_Receptors_Rdata/iTALK_database.rda")
database_Oscar <- database
load("Ligand_Receptors_Rdata/Maisa_download/LR_database.rda")
database_Maisa <- database
# ***************
# iTALK database
load("Ligand_Receptors_Rdata/iTALK_database.rda")
cytokine.iTALK <- subset(database, Classification == "cytokine")
CYTOKINE.pairs_iTALK <- cytokine.iTALK$Pair.Name
CYTOKINES_iTALK <- unique(c(sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), head, 1), sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), tail, 1)))
# Obtaining cytokine pairs from iTALK database
keep_pairs <- intersect(which(cytokine.iTALK$Ligand.ApprovedSymbol %in% CYTOKINES_iTALK),
which(cytokine.iTALK$Receptor.ApprovedSymbol %in% CYTOKINES_iTALK))
CYTOKINE.pairs_iTALK <- cytokine.iTALK[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_iTALK <- unique(CYTOKINE.pairs_iTALK$Pair.Name)
CYTOKINES_iTALK <- unique(c(sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_", fixed = TRUE), head, 1),
sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_", fixed = TRUE), tail, 1)))
# Take corrected HGNC symbols:
write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
# ***************
# CellPhoneDB database
CellPhoneDB.database_Oscar <- read.csv("Ligand_Receptors_Rdata/cellphonedb_protein_curated.csv", header = TRUE, sep = ",")
CellPhoneDB.database_Maisa <- read.csv("Ligand_Receptors_Rdata/Maisa_download/protein_complex_cellphonedb.csv", header = TRUE, sep = ",")
# ***************
# CellPhoneDB database
CellPhoneDB.database_Oscar <- read.csv("Ligand_Receptors_Rdata/cellphonedb_protein_curated.csv", header = TRUE, sep = ",")
# CellPhoneDB.database_Maisa <- read.csv("Ligand_Receptors_Rdata/Maisa_download/protein_complex_cellphonedb.csv", header = TRUE, sep = ",")
keep_Oscar <- unique(c(grep("Cytokine", CellPhoneDB.database_Oscar$secreted_desc, fixed = FALSE), grep("Cytokine", CellPhoneDB.database_Oscar$receptor_desc, fixed = FALSE)))
keep_Maisa <- unique(c(grep("Cytokine", CellPhoneDB.database_Maisa$secreted_desc, fixed = FALSE)))
CYTOKINES_CellPhoneDB <- CellPhoneDB.database_Oscar[keep_Oscar,]
CYTOKINES_CellPhoneDB <- sapply(strsplit(CYTOKINES_CellPhoneDB$entry_name[1:146], split = "_", fixed = T), head, 1)
CYTOKINES_CellPhoneDB
CYTOKINES_CellPhoneDB <- sapply(strsplit(CYTOKINES_CellPhoneDB$protein_name, split = "_", fixed = T), head, 1)
CYTOKINES_CellPhoneDB
# Take corrected HGNC symbols:
write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
View(CYTOKINES_iTALK.corrected)
View(cytokine.iTALK)
CYTOKINES_iTALK
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso
View(CYTOKINES_ImmuneXpresso.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol),]
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB
View(CYTOKINES_ImmuneXpresso.corrected)
View(CYTOKINES_CellPhoneDB.corrected)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
View(CYTOKINES_CellPhoneDB.corrected)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL)
View(CYTOKINES_CellPhoneDB.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
CYTOKINES_iTALK.corrected
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol),]
CYTOKINES_ImmuneXpresso
CYTOKINES_ImmuneXpresso.corrected
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
CYTOKINES_CellPhoneDB.corrected
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
CYTOKINES_CellPhoneDB.corrected
?read.csv
CYTOKINES_ImmuneXpresso
View(CYTOKINES_ImmuneXpresso.corrected)
View(CYTOKINES_iTALK.corrected)
CYTOKINES_iTALK
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
View(CYTOKINES_iTALK.corrected)
CYTOKINES_iTALK
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
View(CYTOKINES_ImmuneXpresso.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
View(CYTOKINES_iTALK.corrected)
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
View(CYTOKINES_iTALK.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
View(CYTOKINES_iTALK.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
# Obtain iTALK pairs:
for (X in 1:nrow(CYTOKINES_iTALK.corrected)){
CYTOKINE.pairs_iTALK <- gsub(CYTOKINES_iTALK.corrected$Input[X],CYTOKINES_iTALK.corrected$Approved.symbol[X],
CYTOKINE.pairs_iTALK, fixed = F)
}
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso
View(CYTOKINES_ImmuneXpresso.corrected)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol),]
# Matching with Ramilowski L-R pairs (only ligands)
keep_pairs <- which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_ImmuneXpresso.corrected$Approved.symbol)
CYTOKINE.pairs_ImmuneXpresso <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_ImmuneXpresso <- unique(CYTOKINE.pairs_ImmuneXpresso$Pair.Name)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB
View(CYTOKINES_CellPhoneDB.corrected)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
# Obtain CellPhoneDB cytokine pairs:
# Matching with Ramilowski
keep_pairs <- unique(c(which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol),
which(LR.pairs.Ramilowski$Receptor.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol)))
CYTOKINE.pairs_CellPhoneDB <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_CellPhoneDB <- unique(CYTOKINE.pairs_CellPhoneDB$Pair.Name)
# Obtain iTALK cytokine pairs:
for (X in 1:nrow(CYTOKINES_iTALK.corrected)){
CYTOKINE.pairs_iTALK <- gsub(CYTOKINES_iTALK.corrected$Input[X],CYTOKINES_iTALK.corrected$Approved.symbol[X],
CYTOKINE.pairs_iTALK, fixed = F)
}
# Obtain ImmuneExpresso cytokine pairs:
# Matching with Ramilowski L-R pairs (only ligands)
keep_pairs <- which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_ImmuneXpresso.corrected$Approved.symbol)
CYTOKINE.pairs_ImmuneXpresso <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_ImmuneXpresso <- unique(CYTOKINE.pairs_ImmuneXpresso$Pair.Name)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
# Obtain CellPhoneDB cytokine pairs:
# Matching with Ramilowski
keep_pairs <- unique(c(which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol),
which(LR.pairs.Ramilowski$Receptor.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol)))
CYTOKINE.pairs_CellPhoneDB <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_CellPhoneDB <- unique(CYTOKINE.pairs_CellPhoneDB$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
we_have_more
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
View(CYTOKINE.pairs_iTALK)
CYTOKINES_iTALK.corrected
View(CYTOKINES_iTALK.corrected)
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol"))
View(CYTOKINES_iTALK.corrected)
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Approved.symbol),]
# Obtain iTALK cytokine pairs:
for (X in 1:nrow(CYTOKINES_iTALK.corrected)){
CYTOKINE.pairs_iTALK <- gsub(CYTOKINES_iTALK.corrected$Input[X],CYTOKINES_iTALK.corrected$Approved.symbol[X],
CYTOKINE.pairs_iTALK, fixed = F)
}
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Approved.symbol),]
# Obtain ImmuneExpresso cytokine pairs:
# Matching with Ramilowski L-R pairs (only ligands)
keep_pairs <- which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_ImmuneXpresso.corrected$Approved.symbol)
CYTOKINE.pairs_ImmuneXpresso <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_ImmuneXpresso <- unique(CYTOKINE.pairs_ImmuneXpresso$Pair.Name)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Approved.symbol),]
# Obtain CellPhoneDB cytokine pairs:
# Matching with Ramilowski
keep_pairs <- unique(c(which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol),
which(LR.pairs.Ramilowski$Receptor.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol)))
CYTOKINE.pairs_CellPhoneDB <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_CellPhoneDB <- unique(CYTOKINE.pairs_CellPhoneDB$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
we_have_more
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Input),]
View(CYTOKINES_iTALK.corrected)
# Obtain iTALK cytokine pairs:
for (X in 1:nrow(CYTOKINES_iTALK.corrected)){
CYTOKINE.pairs_iTALK <- gsub(CYTOKINES_iTALK.corrected$Input[X],CYTOKINES_iTALK.corrected$Approved.symbol[X],
CYTOKINE.pairs_iTALK, fixed = F)
}
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_ImmuneXpresso, file = "Ligand_Receptors_Rdata/unique_cytokines_ImmuneXpresso_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_ImmuneXpresso.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-2.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_ImmuneXpresso.corrected <- subset(CYTOKINES_ImmuneXpresso.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_ImmuneXpresso.corrected <- CYTOKINES_ImmuneXpresso.corrected[!duplicated(CYTOKINES_ImmuneXpresso.corrected$Input),]
# Obtain ImmuneExpresso cytokine pairs:
# Matching with Ramilowski L-R pairs (only ligands)
keep_pairs <- which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_ImmuneXpresso.corrected$Approved.symbol)
CYTOKINE.pairs_ImmuneXpresso <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_ImmuneXpresso <- unique(CYTOKINE.pairs_ImmuneXpresso$Pair.Name)
# Take corrected HGNC symbols:
# write.csv(CYTOKINES_CellPhoneDB, file = "Ligand_Receptors_Rdata/unique_cytokines_CellPhoneDB_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_CellPhoneDB.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check-3.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_CellPhoneDB.corrected <- subset(CYTOKINES_CellPhoneDB.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_CellPhoneDB.corrected <- CYTOKINES_CellPhoneDB.corrected[!duplicated(CYTOKINES_CellPhoneDB.corrected$Input),]
# Obtain CellPhoneDB cytokine pairs:
# Matching with Ramilowski
keep_pairs <- unique(c(which(LR.pairs.Ramilowski$Ligand.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol),
which(LR.pairs.Ramilowski$Receptor.ApprovedSymbol %in% CYTOKINES_CellPhoneDB.corrected$Approved.symbol)))
CYTOKINE.pairs_CellPhoneDB <- LR.pairs.Ramilowski[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_CellPhoneDB <- unique(CYTOKINE.pairs_CellPhoneDB$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
we_have_more
View(CYTOKINE.pairs_CellPhoneDB)
View(CYTOKINE.pairs_ImmuneXpresso)
View(CYTOKINE.pairs_iTALK)
View(database)
# ***************
# iTALK database
load("Ligand_Receptors_Rdata/iTALK_database.rda")
cytokine.iTALK <- subset(database, Classification == "cytokine")
CYTOKINE.pairs_iTALK <- cytokine.iTALK$Pair.Name
CYTOKINES_iTALK <- unique(c(sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), head, 1), sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_"), tail, 1)))
# Obtaining cytokine pairs from iTALK database
keep_pairs <- intersect(which(cytokine.iTALK$Ligand.ApprovedSymbol %in% CYTOKINES_iTALK),
which(cytokine.iTALK$Receptor.ApprovedSymbol %in% CYTOKINES_iTALK))
CYTOKINE.pairs_iTALK <- cytokine.iTALK[na.exclude(keep_pairs),"Pair.Name", drop = FALSE]
CYTOKINE.pairs_iTALK <- unique(CYTOKINE.pairs_iTALK$Pair.Name)
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
we_have_more
View(CYTOKINE.pairs_iTALK)
View(database)
CYTOKINES_iTALK <- unique(c(sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_", fixed = TRUE), head, 1),
sapply(strsplit(CYTOKINE.pairs_iTALK, split = "_", fixed = TRUE), tail, 1)))
# Take corrected HGNC symbols:
#write.csv(CYTOKINES_iTALK, file = "Ligand_Receptors_Rdata/unique_cytokines_iTALK_input.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
CYTOKINES_iTALK.corrected <- read.csv(file = "Ligand_Receptors_Rdata/hgnc-symbol-check.csv", header = TRUE, row.names = NULL, skip = 1)
CYTOKINES_iTALK.corrected <- subset(CYTOKINES_iTALK.corrected, Match.type %in% c("Approved symbol", "Previous symbol", "Alias symbol"))
CYTOKINES_iTALK.corrected <- CYTOKINES_iTALK.corrected[!duplicated(CYTOKINES_iTALK.corrected$Input),]
# Obtain iTALK cytokine pairs:
for (X in 1:nrow(CYTOKINES_iTALK.corrected)){
CYTOKINE.pairs_iTALK <- gsub(CYTOKINES_iTALK.corrected$Input[X],CYTOKINES_iTALK.corrected$Approved.symbol[X],
CYTOKINE.pairs_iTALK, fixed = F)
}
# ***************
# Intersecting cytokine -cytokine receptor pairs in the three databases
CYTOKINE.pairs_subnetwork <- Reduce(intersect, list(CYTOKINE.pairs_iTALK, CYTOKINE.pairs_ImmuneXpresso, CYTOKINE.pairs_CellPhoneDB))
# Intersecting cytokines in the three databases
CYTOKINES_subnetwork <- Reduce(intersect, list(CYTOKINES_iTALK.corrected$Approved.symbol,
CYTOKINES_ImmuneXpresso.corrected$Approved.symbol,
CYTOKINES_CellPhoneDB.corrected$Approved.symbol))
# ***************
# Comparing with Maisa externship intersection
we_have_more <- setdiff(CYTOKINE.pairs_subnetwork, colnames(DataViews.no_filter$CYTOKINEpairs))
setdiff(colnames(DataViews.no_filter$CYTOKINEpairs), CYTOKINE.pairs_subnetwork)
we_have_more
View(database)
View(database_Maisa)
View(CellPhoneDB.database_Maisa)
View(CellPhoneDB.database_Oscar)
View(database.ImmuneXpresso)
CYTOKINES_subnetwork
View(LR.pairs.Ramilowski)
View(filtered.LR.pairs.Ramilowski)
# ***************
# save list of cytokines pairs derived from intersection between the three databases
# filtered for L-R pairs only in the TME:
which(CYTOKINE.pairs_subnetwork %in% filtered.LR.pairs.Ramilowski)
# ***************
# save list of cytokines pairs derived from intersection between the three databases
# filtered for L-R pairs only in the TME:
which(CYTOKINE.pairs_subnetwork %in% LR.pairs_network_Oscar)
# ***************
# save list of cytokines pairs derived from intersection between the three databases
# filtered for L-R pairs only in the TME:
which(LR.pairs_network_Oscar %in% CYTOKINE.pairs_subnetwork)
CYTOKINE.pairs_subnetwork
write.csv(genes_that_need_updated, file = "Ligand_Receptors_Rdata/genes_from_intermediate_table_to_update.csv", quote = FALSE, row.names = FALSE, col.names = FALSE)
# ***************
# save list of cytokines pairs derived from intersection between the three databases
# filtered for L-R pairs only in the TME:
which(CYTOKINE.pairs_subnetwork %in% LR.pairs_network_Oscar)
CYTOKINE.pairs_subnetwork %in% LR.pairs_network_Oscar
?match
# ***************
# save list of cytokines pairs derived from intersection between the three databases
# filtered for L-R pairs only in the TME:
CYTOKINE.pairs_subnetwork <- CYTOKINE.pairs_subnetwork[which(CYTOKINE.pairs_subnetwork %in% LR.pairs_network_Oscar)]
save(CYTOKINE.pairs_subnetwork, file = "Ligand_Receptors_Rdata/CYTOKINE_pairs_subnetwork_only_TME.RData")
load("~/Desktop/PhD_TU:e/Research/mechanistic_biomarkers_immuno-oncology/data/Ligand_Receptors_Rdata/LR_pairs_network_only_TME.RData")
