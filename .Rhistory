#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())#, axis.line.y = element_line(size=0.5, colour = "gray"))    #ggtitle(paste0("Common-median performance (cv - 100 iterations)"))
ggplot(summary_view_all.SpCorr_1se.mse.EN, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
theme_light(base_size=13)+
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
# theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())#, axis.line.y = element_line(size=0.5, colour = "gray"))    #ggtitle(paste0("Common-median performance (cv - 100 iterations)"))
ggplot(summary_view_all.SpCorr_1se.mse.EN, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
theme_light(base_size=13)+
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
# theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
ggtitle("Multi-task Lasso regression (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_MT_EN_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 8, height = 8)
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
theme_light(base_size=13)+
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
# theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 8, height = 8)
0
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10))
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
theme_light(base_size=13)+
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
# theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10))
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10)
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), strip.text = element_text(size=10,face="bold"),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10)
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
strip.text = element_text(size=10,face="bold", hjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
strip.text = element_text(size=10,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=10,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.92, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10)
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.9, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 8)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.9, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 7)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.9, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 15)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggplot(summary_view_all.SpCorr_1se.mse.BA, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.9, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 10)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("BEMKL (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_BEMKL_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10)
ggplot(summary_view_all.SpCorr_1se.mse.EN, aes(x = DataType, y = perf_min, fill = DataType,
colour = DataType, group = DataType)) + # , alpha = algorithm)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
scale_color_manual(name = "Mechanistic signature",
labels = levels(summary_view_all.SpCorr_1se.mse$DataType),
values = as.vector(colors.DataType)) +
# scale_alpha_manual(name = "Algorithm",
#                   labels = levels(summary_view_all.SpCorr_1se.mse$algorithm),
#                   values = c(0.93,0.4)) +
geom_signif(comparisons = list(c("ImmuneCells","ImmuneCells_sTIL")), tip_length = .01,
color = "black", y_position = 0.9, map_signif_level = TRUE) +
theme_minimal() +
coord_fixed(ratio = 10)+
facet_grid(. ~ CancerType) +
# scale_x_discrete(labels = c("immunecells"= "ImmuneCells",
#                             # "LRpairs"= "L-R pairs",
#                             "CYTOKINEpairs"= "Cytokine pairs",
#                             "pathways"="Pathways",
#                             "pathways_immunecells"="Pathways \n + \n Immunecells",
#                             # "TFs" = "TFs",
#                             "transcript" = "Transcriptomics")) +
scale_x_discrete (labels = c("ImmuneCells_sTIL" = "ImmuneCells \n       +       \n      sTIL  ")) +
theme(axis.text.x = element_text(size=8,face="bold", angle = 55, hjust = 1), axis.title.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
strip.text = element_text(size=8,face="bold", vjust = 1),
axis.title.y = element_blank(), legend.position = "none",
# legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank()) + #, axis.line.y = element_line(size=0.5, colour = "gray"))
# ggtitle("Multi-task Lasso regression (using common median)")
ggtitle("Multi-task Lasso (using common median)")
ggsave(paste0("./figures/PanCancer_draft_v1/PanCancer_MTEN_immunecells_sTIL_training_performance_SpCorr_1SE_MSE.pdf"), width = 10, height = 10)
