guide = F) +
theme_minimal() +
# coord_fixed(ratio = 3)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 3)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
# ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
#         subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 3)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(summary_view_features.mech_sig.cancer.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
scale_color_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
theme_minimal() +
# ylim(c(-0.1,0.9)) +
# coord_fixed(ratio = 2) +
geom_hline(yintercept = 0, linetype="dashed") +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_text(size=20,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_text(size=16,face="bold",vjust = 0.9),
axis.text.y = element_text(size=20,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=16,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = c(0.85,0.8), legend.direction = "vertical",
legend.text=element_text(size=13), legend.title = element_text(size = 12, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_blank()) +
labs(y = "estimated coefficient", x = "features")
ggplot(summary_view_features.mech_sig.cancer.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
scale_color_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
theme_minimal() +
# ylim(c(-0.1,0.9)) +
# coord_fixed(ratio = 2) +
geom_hline(yintercept = 0, linetype="dashed") +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_text(size=20,face="bold", angle = 30, vjust = 0.5, hjust=0.5), axis.title.x = element_text(size=16,face="bold",vjust = 0.9),
axis.text.y = element_text(size=20,face="bold"), axis.ticks.x = element_blank(), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=16,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = c(0.85,0.8), legend.direction = "vertical",
legend.text=element_text(size=13), legend.title = element_text(size = 12, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_blank()) +
labs(y = "estimated coefficient", x = "features")
ggplot(summary_view_features.mech_sig.cancer.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
scale_color_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
theme_minimal() +
# ylim(c(-0.1,0.9)) +
# coord_fixed(ratio = 2) +
geom_hline(yintercept = 0, linetype="dashed") +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_text(size=20,face="bold", angle = 90, vjust = 0.5, hjust=0.5), axis.title.x = element_text(size=16,face="bold",vjust = 0.9),
axis.text.y = element_text(size=20,face="bold"), axis.ticks.x = element_blank(), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=16,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = c(0.85,0.8), legend.direction = "vertical",
legend.text=element_text(size=13), legend.title = element_text(size = 12, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_blank()) +
labs(y = "estimated coefficient", x = "features")
ggplot(summary_view_features.mech_sig.cancer.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
scale_color_manual(name = "Task",
labels = as.vector(unique(summary_view_features.mech_sig.cancer.task$task)),
values = "#999a3e") +
theme_minimal() +
# ylim(c(-0.1,0.9)) +
# coord_fixed(ratio = 2) +
geom_hline(yintercept = 0, linetype="dashed") +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_text(size=20,face="bold", angle = 90, vjust = 0.5, hjust=0.5), axis.title.x = element_text(size=16,face="bold",vjust = 0.9),
axis.text.y = element_text(size=20,face="bold"), axis.ticks.x = element_blank(), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=16,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = c(0.85,0.8), legend.direction = "vertical",
legend.text=element_text(size=16), legend.title = element_text(size = 12, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_blank()) +
labs(y = "estimated coefficient", x = "features")
ggsave(paste0("../Figures/BIM_cluster_presentation/Boxplot_displaying_coef_pathways_immunecells_1se_mse_model_cor_CYT.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 3)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
coord_fixed(ratio = 2)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
5#axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
coord_fixed(ratio = 5)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
coord_fixed(ratio = 5)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
coord_fixed(ratio = 1)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 1)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank())
axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
# ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
#         subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 1)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
axis.line = element_line(size=0.5, colour = "black"), aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
# ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
#         subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="black") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 1)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
#axis.line = element_line(size=0.5, colour = "black"),
aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
# ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
#         subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(frequency.iterations.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_bar(stat="identity", color="red") +
# geom_text(aes(label= sign.feature), stat = "identity", color="black", size = 1,
#           position = position_stack(vjust = 0.5)) +
scale_fill_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
scale_color_manual(name = "Task",
labels = "CYT",
values = "red",
guide = F) +
theme_minimal() +
# coord_fixed(ratio = 1)+
# facet_grid(task ~ .) +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),
axis.text.y = element_text(size=12,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=12,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = "bottom", legend.direction = "horizontal",  strip.text.y = element_text(angle = 360),
legend.text=element_text(size=9), legend.title = element_text(size = 10, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(),
#axis.line = element_line(size=0.5, colour = "black"),
aspect.ratio = 0.05) +
labs(y = "Number of\n times") +
# ggtitle(paste0(input," - ", Cancer,": feature selection all tasks in min MSE + 1SE model"),
#         subtitle = "* Balance classes of directions due to coefficients close to zero are resolved with sign = 0")
ggsave(paste0("../figures/BIM_cluster_presentation/Features_stability_pathways_immunecells_cor_tasks.pdf"), width = 12, height = 12)
ggplot(summary_view_features.mech_sig.cancer.task, aes(x = feature, y = estimate, fill = task, color = task)) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(name = "Task",
labels = "Cytolytic Activity",
values = "#999a3e") +
scale_color_manual(name = "Task",
labels = "Cytolytic Activity",
values = "#999a3e") +
theme_minimal() +
# ylim(c(-0.1,0.9)) +
# coord_fixed(ratio = 2) +
geom_hline(yintercept = 0, linetype="dashed") +
scale_x_discrete(labels = c("T_cells_CD8" = "CD8 T cells",
"Macrophages_M2"= "M2",
"B_cells" = "B cells",
"T_cells_regulatory_Tregs" = "Tregs",
"Macrophages_M1"= "M1",
"T_cells_CD4" = "CD4 T cells",
"NK_cells" = "NK cells",
"Dendritic_cells" = "DC cells")) +
theme(axis.text.x = element_text(size=20,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_text(size=16,face="bold",vjust = 0.9),
axis.text.y = element_text(size=20,face="bold"), axis.ticks.x = element_blank(), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=16,face="bold",vjust = 0.9), strip.background = element_blank(), panel.spacing.y =  unit(1, "lines"),
legend.position = c(0.85,0.8), legend.direction = "vertical",
legend.text=element_text(size=18), legend.title = element_text(size = 12, face="bold", vjust = 0.5),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_blank()) +
labs(y = "estimated coefficient", x = "features")
ggsave(paste0("../Figures/BIM_cluster_presentation/Boxplot_displaying_coef_pathways_immunecells_1se_mse_model_cor_CYT.pdf"), width = 12, height = 12)
