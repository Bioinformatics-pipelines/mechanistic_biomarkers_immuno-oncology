position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.Riaz, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "Liu"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.Riaz, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "Auslander"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "Gide"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
tmp.barplot.both$Dataset
dataset <- "comb.Gide_Auslander" # "comb.Hugo_Liu_Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "comb.Hugo_Liu_Riaz" # "comb.Hugo_Liu_Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
dataset <- "Hugo" # "comb.Hugo_Liu_Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
View(All.DataViews.test)
# Subset #
CancerType <- "GBM" # "SKCM", "STAD"
tmp.barplot <- subset(AUC.mean.sd, Cancer == CancerType)
tmp.barplot$Task <- factor(tmp.barplot$Task, levels = c("CYT","IS","RohIS", "chemokine","IS_Davoli",
"IFny","ExpandedImmune", "T_cell_inflamed",
"common_mean","common_median"))
tmp.barplot$Analysis <- factor(tmp.barplot$Analysis)
tmp.barplot.EN <- subset(tmp.barplot, Model == "Multi_Task_EN" & cv_model == "1se.mse")
tmp.barplot.BE <- subset(tmp.barplot, Model == "BEMKL")
tmp.barplot.both <- rbind(tmp.barplot.EN, tmp.barplot.BE)
tmp.barplot.both$Model <- factor(tmp.barplot.both$Model)
dataset <- "Zhao" # "comb.Hugo_Liu_Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
# Subset #
CancerType <- "STAD" # "SKCM", "STAD" "GBM
tmp.barplot <- subset(AUC.mean.sd, Cancer == CancerType)
tmp.barplot$Task <- factor(tmp.barplot$Task, levels = c("CYT","IS","RohIS", "chemokine","IS_Davoli",
"IFny","ExpandedImmune", "T_cell_inflamed",
"common_mean","common_median"))
tmp.barplot$Analysis <- factor(tmp.barplot$Analysis)
tmp.barplot.EN <- subset(tmp.barplot, Model == "Multi_Task_EN" & cv_model == "1se.mse")
tmp.barplot.BE <- subset(tmp.barplot, Model == "BEMKL")
tmp.barplot.both <- rbind(tmp.barplot.EN, tmp.barplot.BE)
tmp.barplot.both$Model <- factor(tmp.barplot.both$Model)
dataset <- "Kim" # "comb.Hugo_Liu_Riaz"
tmp.barplot.both.tmp <- subset(tmp.barplot.both, Dataset == dataset)
# Barplot #
ggplot2::ggplot(tmp.barplot.both.tmp, aes(x=View, y=round(AUC.median,2), fill=Task,
colour = Task, alpha = Model)) +
ggplot2::geom_bar(stat="identity", position = position_dodge()) +
ggplot2::scale_fill_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values = as.vector(colors.tasks)) +
ggplot2::scale_color_manual(name = "Task",
labels = levels(tmp.barplot.both$Task),
values =  as.vector(colors.tasks)) +
ggplot2::scale_alpha_manual(name = "Model",
labels = levels(tmp.barplot.both$Model),
values = c(0.93,0.4))  +
ggplot2::theme_classic() +
ggplot2::facet_grid( . ~ Dataset) +
ggplot2::ylim(0, 1) +
ggplot2::ylab("AUC") +
ggplot2::geom_errorbar(aes(ymin = AUC.median - AUC.sd, ymax = AUC.median + AUC.sd),
width=.5, color="gray", position = position_dodge(0.9)) +
ggplot2::geom_text(aes(label= round(AUC.median,2)),stat = "identity", color="black", size = 3, angle = 45,
position = position_dodge(0.9)) +
scale_x_discrete(labels = c("ImmuneCells"= "IC",
"LRpairs"= "L-R",
"CYTOKINEpairs"= "CK-CK",
"Pathways"="PA",
"Pathways_ImmuneCells"="PA + IC",
"TFs" = "TFs",
"Transcript" = "Transcriptomics")) +
ggplot2::geom_hline(yintercept = 0.5, linetype="dashed") +
theme(axis.text.x = element_text(size=10,face="bold", angle = 45, vjust = 0.5, hjust=0.5), axis.title.x = element_blank(),
axis.text.y = element_text(size=10,face="bold"), axis.ticks.x = element_line(size = 1), axis.ticks.y = element_line(size = 1),
axis.title.y = element_text(size=10,face="bold",vjust = 0.9), panel.spacing.y =  unit(1, "lines"),
legend.box.background = element_rect(color="black", size=0.3),
legend.position = c(0.74,0.88), legend.direction = "horizontal",
legend.box.margin = margin(1, 1, 1, 1),
legend.text=element_text(size=8),
legend.title = element_text(size = 8, vjust = 0.5),
strip.background = element_rect(fill = "lightgray", colour = "white"),
panel.border = element_blank(), panel.background = element_blank(), axis.line = element_line(size=0.5, colour = "black"))
ggsave(paste0("../figures/PanCancer_draft_v1/Validation/","Barplot_with_aucs_on_", CancerType, "_", dataset, "_dataset.pdf"),
width = 12, height = 12)
